<div class="row">
    <div class="col-md-7" style="border: 5px solid #cecece;">
        <div id="wrapper" class='mn-studio preview'>
            <div id="droppable"></div>
        </div>
    </div>
    <div class="col-md-5">
        <button type="button" class="btn btn-primary rounded-pill mb-3 mr-2" (click)="saveAll()"><i
            class="fa fa-plus" aria-hidden="true"></i>
        Save all</button>
        <form (ngSubmit)="doSubmit()" [formGroup]="statsForm">
            <div class="row">
                <div formArrayName="blocks" class="stat-box-container">
                    <div class="col-md-6 stat-box"
                        *ngFor="let item of statsForm.get('blocks')['controls']; let b = index;">
                        <div [formGroupName]="b">
                            <h3>Pump {{b+1}}</h3>
                            <hr />
                            <div formArrayName="details">
                                <div class="form-row"
                                    *ngFor="let field of item.get('details')['controls']; let ind = index; let first = first; let last = last"
                                    [formGroupName]="ind">
                                    <div class="form-group col-md-5">
                                        <input type="text" class="form-control" formControlName="name"
                                            placeholder="name">
                                    </div>
                                    <div class="form-group col-md-5"
                                        (click)="openValueDialog(item, field, b, ind, composeEmail)">
                                        <input type="text" class="form-control" formControlName="value"
                                            placeholder="Value">
                                    </div>
                                    <div class="form-group col-md-2 clone-btns">
                                        <i *ngIf="last" class="fa fa-plus add-btn" aria-hidden="true"
                                            (click)="addRow(item)"></i> &nbsp;&nbsp;
                                        <i *ngIf="ind > first" class="fa fa-trash remove-btn" aria-hidden="true"
                                            (click)="removeRow(item, field, ind)"></i>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </form>
    </div>
</div>

<div class="row">
    <ng-template #composeEmail>
        <div id="compose-email-popup">
            <div class="modal-dialog modal-dialog-scrollable modal-dialog-centered" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="exampleModalCenteredScrollableTitle">Value Properties</h5>
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close" (click)="modalRef.hide()">
                            <span aria-hidden="true">Ã—</span>
                        </button>
                    </div>
                    <form id="form-wizard3" [formGroup]="modalForm" (submit)="addNewMimic()">
                        <div class="modal-body">
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="form-group {{ errorField }}">
                                        <label for="slave_id">Slave Id: *</label>
                                        <input formControlName="slave_id" type="text" class="form-control" name="slave_id" />
                                        <p *ngIf="modalForm.controls['slave_id'].hasError('required') && isSubmitted" class="error-msg">
                                        <i class="fa fa-exclamation"></i> Slave Id is required.
                                        </p>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="form-group {{ errorField }}">
                                        <label for="register_address">Register Address: *</label>
                                        <input formControlName="register_address" type="text" class="form-control" name="register_address" />
                                        <p *ngIf="modalForm.controls['register_address'].hasError('required') && isSubmitted" class="error-msg">
                                        <i class="fa fa-exclamation"></i> Register Address is required.
                                        </p>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="form-group {{ errorField }}">
                                        <label for="data_type">Data Type: *</label>
                                        <select formControlName="data_type" class="form-control">
                                            <option value="integer" selected>Integer</option>
                                            <option value="float">Float</option>
                                        </select>
                                        <p *ngIf="modalForm.controls['data_type'].hasError('required') && isSubmitted" class="error-msg">
                                        <i class="fa fa-exclamation"></i> Data Type is required.
                                        </p>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="form-group {{ errorField }}">
                                        <label for="unit">Unit: *</label>
                                        <input formControlName="unit" type="text" class="form-control" name="unit" />
                                        <p *ngIf="modalForm.controls['unit'].hasError('required') && isSubmitted" class="error-msg">
                                        <i class="fa fa-exclamation"></i> Unit is required.
                                        </p>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-primary" (click)="confirm(modalService.config.data.item,modalService.config.data.field,modalService.config.data.b, modalService.config.data.ind)">Save changes</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </ng-template>
</div>